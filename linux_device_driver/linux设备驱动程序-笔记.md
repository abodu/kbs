## 设备驱动程序作用

大多数编程问题实际上都可以分成两部分：

> 需要提供什么功能**(`机制`)**  和 如何使用这些功能**(`策略`)**

设备驱动程序的作用: **在于提供机制**，而不是提供策略(通常由系统高层提供策略)。

驱动程序员需要特别注意下面的基本概念:
>`编写访问硬件的内核代码时,不要给用户强加任何特定的策略`。

驱动程序应该处理: `如何使硬件可用(提供访问硬件的功能)的问题`，而不是用户怎样使用硬件的问题。

## 设备和模块的分类

### 字符设备

- 够像字节流(类似文件) 一样被访问的设备
- 其驱动程序通常至少要实现 `open`, `close`, `read`, `write` 系统调用
- 典型的字符设备: 字符终端(`/dev/console`) 和 串口(`/dev/ttys0及类似设备`)
- 字符设备通过/dev目录下的文件系统节点来访问。
- 字符设备和普通文件之间的唯一差别:
  - 普通文件的访问可以前后移动访问位置
  - 大多数字符设备是一个只能顺序访问的数据通道。

### 块设备

- 和字符设备类似，块设备也是通过/dev目录下的文件系统节点来访问。
- 块设备上能够容纳文件系统。
- 块设备和字符设备的区别仅在于linux内核内部管理数据的方式
  - 在内核中，和字符驱动程序相比，块设备驱动程序具有完全不同的接口。

### 网络接口

- 任何网络事务都需经过一个网络接口(`一个能够和其他主机交换数据的设备`)形成。
  
  > 通常,接口是个硬件设备(比如`网卡`),但也可能是纯软件设备(比如`loopback接口`)
  
- 网络接口由内核中的网络子系统驱动，负责发送和接收数据包。

- 内核与网络设备驱动程序间的通信，完全不同于内核与字符/块驱动程序之间的通信

  > 内核将调用一套和数据包传输相关的函数而不是read，write 等

**文件系统:**

- 一个文件系统类型决定了如何在块设备上组织数据，以表示目录和文件形成的树。
- 文件系统类型是个软件驱动程序,它的功能包含：
  - 将低层数据结构映射到高层数据结构；
  - 决定文件名可以有多长；
  - 在目录项中存储文件的哪些信息等等
